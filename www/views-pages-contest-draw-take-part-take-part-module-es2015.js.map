{"version":3,"sources":["./src/app/views/pages/contest-draw/take-part/take-part.page.html","./src/app/views/pages/contest-draw/take-part/take-part.module.ts","./src/app/views/pages/contest-draw/take-part/take-part.page.scss","./src/app/views/pages/contest-draw/take-part/take-part.page.ts"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAe,2cAA4Y,YAAY,wEAAwE,YAAY,wcAAwc,E;;;;;;;;;;;;;;;;;;;;;ACA15B;AACM;AACC;AACQ;AACD;AAEvD,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,4DAAY;KACxB;CACF,CAAC;IASW,kBAAkB,SAAlB,kBAAkB;CAAG;AAArB,kBAAkB;IAR9B,8DAAQ,CAAC;QACR,OAAO,EAAE;YACP,4DAAY;YACZ,qEAAY;YACZ,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;SAC9B;QACD,YAAY,EAAE,CAAC,4DAAY,CAAC;KAC7B,CAAC;GACW,kBAAkB,CAAG;AAAH;;;;;;;;;;;;;ACpB/B;AAAe,4EAAa,kBAAkB,4BAA4B,GAAG,yBAAyB,6CAA6C,GAAG,6CAA6C,uiBAAuiB,E;;;;;;;;;;;;;;;;;;;;;;ACA7qB;AAEZ;AACwB;AACP;AACN;AACI;IAOnD,YAAY,SAAZ,YAAY;IAcvB,YACmB,cAA8B,EACvC,kBAAsC,EACtC,QAAyB,EACzB,YAA0B,EAC3B,eAAgC,EAC/B,OAAsB;QALb,mBAAc,GAAd,cAAc,CAAgB;QACvC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,aAAQ,GAAR,QAAQ,CAAiB;QACzB,iBAAY,GAAZ,YAAY,CAAc;QAC3B,oBAAe,GAAf,eAAe,CAAiB;QAC/B,YAAO,GAAP,OAAO,CAAe;QAlBhC,SAAI,GAAgB,IAAI,CAAC;QAIzB,iBAAY,GAAG,KAAK,CAAC;QAErB,SAAI,GAAkB;YACpB,MAAM,EAAE,KAAK;YACb,KAAK,EAAE,IAAI;YACX,GAAG,EAAE,IAAI;SACV,CAAC;QASA,IAAI,CAAC,OAAO,EAAE,CAAC;IACjB,CAAC;IAED,QAAQ,KAAK,CAAC;IAEd;;OAEG;IACG,OAAO;;YACX,IAAI;gBACF,MAAM,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;gBAClC,MAAM,MAAM,GAAG,IAAI,IAAI,EAAE,CAAC;gBAC1B,IAAI,CAAC,IAAI,GAAG,CAAC,GAAG,GAAG,MAAM,CAAC,OAAO,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,MAAM,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,MAAM,CAAC,WAAW,EAAE,CAAC;gBAC9H,MAAM,GAAG,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,YAAY,EAAE,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAE,yBAAyB;gBAC7I,MAAM,CAAC,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,wBAAwB,CAAC,YAAY,EAAE,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBACvH,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,CAAC,SAAS,CAAC,CAAO,KAAU,EAAE,EAAE,CAAC;oBAEtD,MAAM,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;wBACzB,MAAM,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;wBACtC,IAAI,KAAK,CAAC,GAAG,IAAI,KAAK,CAAC,GAAG,KAAK,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,EAAE;4BACzD,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;yBAC1B;oBACH,CAAC,CAAC,CAAC;gBAEL,CAAC,EAAC,CAAC;gBACH,IAAI,CAAC,MAAM,GAAG,MAAM,GAAG,CAAC,SAAS,CAAC,CAAO,CAAM,EAAE,EAAE,CAAC;oBAClD,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;gBACrC,CAAC,EAAC,CAAC;aACJ;YAAC,OAAO,KAAK,EAAE;gBACd,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;gBACrB,MAAM,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;aACnC;oBAAS;gBACR,MAAM,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;aACnC;QACH,CAAC;KAAA;IAED;;OAEG;IACG,YAAY;;YAChB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,QAAQ,EAAE,iBAAiB;gBAC3B,MAAM,EAAE,OAAO;gBACf,OAAO,EAAE,iDAAiD;gBAC1D,eAAe,EAAE,KAAK;gBACtB,OAAO,EAAE;oBACP;wBACE,IAAI,EAAE,UAAU;qBACjB;oBAAE;wBACD,IAAI,EAAE,SAAS;wBACf,OAAO,EAAE,GAAS,EAAE,CAAC;4BACnB,IAAI;gCACF,MAAM,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;gCAC/C,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC;gCAC/C,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC;gCAC3C,MAAM,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,YAAY,EAAE,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAE,yBAAyB;gCAC3I,MAAM,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,4CAA4C,CAAC,CAAC;gCAC5E,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;6BACrB;4BAAC,OAAO,KAAK,EAAE;gCACd,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;gCACrB,MAAM,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;6BACnC;oCAAS;gCACR,MAAM,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;6BACnC;wBACH,CAAC;qBACF;iBACF;aACF,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;KAAA;IAED,WAAW;QACT,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;QAC1B,IAAI,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;IAC9B,CAAC;CAEF;;YA5GQ,8DAAc;YACd,sFAAkB;YAClB,+EAAe;YACf,yEAAY;YACZ,8DAAe;YAAE,4DAAa;;AAO1B,YAAY;IALxB,+DAAS,CAAC;QACT,QAAQ,EAAE,eAAe;QACzB,sPAAoC;;KAErC,CAAC;mFAgBmC,8DAAc;QACnB,sFAAkB;QAC5B,+EAAe;QACX,yEAAY;QACV,8DAAe;QACtB,4DAAa;GApBrB,YAAY,CAiGxB;AAjGwB","file":"views-pages-contest-draw-take-part-take-part-module-es2015.js","sourcesContent":["export default \"<app-header [showBackButton]=\\\"false\\\" name=\\\"Concursos-sorteos\\\">\\n  <ion-buttons start>\\n    <ion-back-button defaultHref=\\\"/contest-draw\\\" text=\\\"\\\" icon=\\\"chevron-back-outline\\\"></ion-back-button>\\n  </ion-buttons>\\n</app-header>\\n\\n<ion-content>\\n  <ng-container *ngIf=\\\"data != null\\\">\\n    <ion-card>\\n      <img [src]=\\\"data.img\\\" />-\\n      <ion-card-header>\\n        <ion-card-title>{{data.title}}</ion-card-title>\\n      </ion-card-header>\\n      <ion-card-content> {{data.info }}</ion-card-content>\\n    </ion-card>\\n    <br>\\n\\n    <div class=\\\"take-part\\\">\\n      <ng-container [ngSwitch]=\\\"participated\\\">\\n        <ion-button *ngSwitchCase=\\\"true\\\" expand=\\\"block\\\" shape=\\\"round\\\" disabled=\\\"true\\\">Ya has participado</ion-button>\\n        <ion-button *ngSwitchCase=\\\"false\\\" (click)=\\\"takePartDraw()\\\" expand=\\\"block\\\" shape=\\\"round\\\">PARTICIPAR</ion-button>\\n      </ng-container>\\n    </div>\\n  </ng-container>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { TakePartPage } from './take-part.page';\nimport { SharedModule } from 'app/shared/shared.module';\nimport { RouterModule, Routes } from '@angular/router';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: TakePartPage\n  }\n];\n@NgModule({\n  imports: [\n    CommonModule,\n    SharedModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [TakePartPage]\n})\nexport class TakePartPageModule {}\n","export default \".take-part {\\n  display: flex;\\n  justify-content: center;\\n}\\n.take-part ion-button {\\n  --background: var(--ion-color-secondary);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdmlld3MvcGFnZXMvY29udGVzdC1kcmF3L3Rha2UtcGFydC90YWtlLXBhcnQucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksYUFBQTtFQUNBLHVCQUFBO0FBQ0o7QUFDSTtFQUNJLHdDQUFBO0FBQ1IiLCJmaWxlIjoic3JjL2FwcC92aWV3cy9wYWdlcy9jb250ZXN0LWRyYXcvdGFrZS1wYXJ0L3Rha2UtcGFydC5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIudGFrZS1wYXJ0IHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXG4gICAgaW9uLWJ1dHRvbiB7XG4gICAgICAgIC0tYmFja2dyb3VuZDogdmFyKC0taW9uLWNvbG9yLXNlY29uZGFyeSk7XG4gICAgfVxufSJdfQ== */\";","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { ContestDraw, Participating } from 'app/shared/models/Contest-Draw.Model';\nimport { ActivatedRoute } from '@angular/router';\nimport { FirebaseAppService } from '@core/services/firebase-app.service';\nimport { MessagesService } from '@core/services/messages.service';\nimport { LoginService } from '@core/services/login.service';\nimport { AlertController, NavController } from '@ionic/angular';\n\n@Component({\n  selector: 'app-take-part',\n  templateUrl: './take-part.page.html',\n  styleUrls: ['./take-part.page.scss'],\n})\nexport class TakePartPage implements OnInit, OnDestroy {\n\n  data: ContestDraw = null;\n  date;\n  result: any; // TODO: CAMBIAR NOMBRE\n  checking: any; // TODO: CAMBIAR NOMBRE\n  participated = false;\n\n  user: Participating = {\n    winner: false,\n    email: null,\n    uid: null,\n  };\n\n  constructor(\n    private readonly activatedRoute: ActivatedRoute,\n    private firebaseAppService: FirebaseAppService,\n    private messages: MessagesService,\n    private loginService: LoginService,\n    public alertController: AlertController,\n    private navCtrl: NavController) {\n    this.getInfo();\n  }\n\n  ngOnInit() { }\n\n  /**\n   * OBTENER DATOS DEL SORTEO SELECCIONADO\n   */\n  async getInfo() {\n    try {\n      await this.messages.showSpinner();\n      const MyDate = new Date();\n      this.date = ('0' + MyDate.getDate()).slice(-2) + '-' + ('0' + (MyDate.getMonth() + 1)).slice(-2) + '-' + MyDate.getFullYear();\n      const res = await this.firebaseAppService.getDataUniqueDraw('27-07-2020', this.activatedRoute.snapshot.params.id);  // ! OJO: FECHA DE PRUEBA\n      const r = await this.firebaseAppService.checkUserHasParticipated('27-07-2020', this.activatedRoute.snapshot.params.id);\n      this.checking = await r.subscribe(async (datos: any) => { // ! OJO: CON EL SUBCRIBE- DESUCRBIBE\n\n        await datos.forEach(item => {\n          const check = item.payload.doc.data();\n          if (check.uid && check.uid === this.loginService.user.uid) {\n            this.participated = true;\n          }\n        });\n\n      });\n      this.result = await res.subscribe(async (d: any) => { // ! OJO: CON EL SUBCRIBE- DESUCRBIBE\n        this.data = await d.payload.data();\n      });\n    } catch (error) {\n      console.error(error);\n      await this.messages.hideSpinner();\n    } finally {\n      await this.messages.hideSpinner();\n    }\n  }\n\n  /**\n   * APUNTARSE A UN SORTEO\n   */\n  async takePartDraw() {\n    const alert = await this.alertController.create({\n      cssClass: 'my-custom-class',\n      header: 'Aviso',\n      message: '¿Está seguro que desea participar en el sorteo?',\n      backdropDismiss: false,\n      buttons: [\n        {\n          text: 'Cancelar',\n        }, {\n          text: 'Aceptar',\n          handler: async () => {\n            try {\n              await this.messages.showSpinner('Cargando...');\n              this.user.email = this.loginService.user.email;\n              this.user.uid = this.loginService.user.uid;\n              await this.firebaseAppService.takePartOnlyDraw('27-07-2020', this.activatedRoute.snapshot.params.id, this.user);  // ! OJO: FECHA DE PRUEBA\n              await this.messages.showToast('Su participación se ha realizado con éxito');\n              this.navCtrl.back();\n            } catch (error) {\n              console.error(error);\n              await this.messages.hideSpinner();\n            } finally {\n              await this.messages.hideSpinner();\n            }\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n  ngOnDestroy() {\n    this.result.unsubscribe();\n    this.checking.unsubscribe();\n  }\n\n}\n"],"sourceRoot":"webpack:///"}