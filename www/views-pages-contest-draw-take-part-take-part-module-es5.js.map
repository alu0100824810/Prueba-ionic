{"version":3,"sources":["webpack:///src/app/views/pages/contest-draw/take-part/take-part.page.html","webpack:///src/app/views/pages/contest-draw/take-part/take-part.module.ts","webpack:///src/app/views/pages/contest-draw/take-part/take-part.page.scss","webpack:///src/app/views/pages/contest-draw/take-part/take-part.page.ts"],"names":["routes","path","component","TakePartPageModule","imports","forChild","declarations","TakePartPage","activatedRoute","firebaseAppService","messages","loginService","alertController","navCtrl","data","participated","user","winner","email","uid","getInfo","showSpinner","MyDate","Date","date","getDate","slice","getMonth","getFullYear","getDataUniqueDraw","snapshot","params","id","res","checkUserHasParticipated","r","subscribe","datos","forEach","item","check","payload","doc","checking","d","result","console","error","hideSpinner","create","cssClass","header","message","backdropDismiss","buttons","text","handler","takePartOnlyDraw","showToast","back","alert","present","unsubscribe","selector","template"],"mappings":"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","file":"views-pages-contest-draw-take-part-take-part-module-es5.js","sourcesContent":["export default \"<app-header [showBackButton]=\\\"false\\\" name=\\\"Concursos-sorteos\\\">\\n  <ion-buttons start>\\n    <ion-back-button defaultHref=\\\"/contest-draw\\\" text=\\\"\\\" icon=\\\"chevron-back-outline\\\"></ion-back-button>\\n  </ion-buttons>\\n</app-header>\\n\\n<ion-content>\\n  <ng-container *ngIf=\\\"data != null\\\">\\n    <ion-card>\\n      <img [src]=\\\"data.img\\\" />-\\n      <ion-card-header>\\n        <ion-card-title>{{data.title}}</ion-card-title>\\n      </ion-card-header>\\n      <ion-card-content> {{data.info }}</ion-card-content>\\n    </ion-card>\\n    <br>\\n\\n    <div class=\\\"take-part\\\">\\n      <ng-container [ngSwitch]=\\\"participated\\\">\\n        <ion-button *ngSwitchCase=\\\"true\\\" expand=\\\"block\\\" shape=\\\"round\\\" disabled=\\\"true\\\">Ya has participado</ion-button>\\n        <ion-button *ngSwitchCase=\\\"false\\\" (click)=\\\"takePartDraw()\\\" expand=\\\"block\\\" shape=\\\"round\\\">PARTICIPAR</ion-button>\\n      </ng-container>\\n    </div>\\n  </ng-container>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { TakePartPage } from './take-part.page';\nimport { SharedModule } from 'app/shared/shared.module';\nimport { RouterModule, Routes } from '@angular/router';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: TakePartPage\n  }\n];\n@NgModule({\n  imports: [\n    CommonModule,\n    SharedModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [TakePartPage]\n})\nexport class TakePartPageModule {}\n","export default \".take-part {\\n  display: flex;\\n  justify-content: center;\\n}\\n.take-part ion-button {\\n  --background: var(--ion-color-secondary);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdmlld3MvcGFnZXMvY29udGVzdC1kcmF3L3Rha2UtcGFydC90YWtlLXBhcnQucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksYUFBQTtFQUNBLHVCQUFBO0FBQ0o7QUFDSTtFQUNJLHdDQUFBO0FBQ1IiLCJmaWxlIjoic3JjL2FwcC92aWV3cy9wYWdlcy9jb250ZXN0LWRyYXcvdGFrZS1wYXJ0L3Rha2UtcGFydC5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIudGFrZS1wYXJ0IHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXG4gICAgaW9uLWJ1dHRvbiB7XG4gICAgICAgIC0tYmFja2dyb3VuZDogdmFyKC0taW9uLWNvbG9yLXNlY29uZGFyeSk7XG4gICAgfVxufSJdfQ== */\";","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { ContestDraw, Participating } from 'app/shared/models/Contest-Draw.Model';\nimport { ActivatedRoute } from '@angular/router';\nimport { FirebaseAppService } from '@core/services/firebase-app.service';\nimport { MessagesService } from '@core/services/messages.service';\nimport { LoginService } from '@core/services/login.service';\nimport { AlertController, NavController } from '@ionic/angular';\n\n@Component({\n  selector: 'app-take-part',\n  templateUrl: './take-part.page.html',\n  styleUrls: ['./take-part.page.scss'],\n})\nexport class TakePartPage implements OnInit, OnDestroy {\n\n  data: ContestDraw = null;\n  date;\n  result: any; // TODO: CAMBIAR NOMBRE\n  checking: any; // TODO: CAMBIAR NOMBRE\n  participated = false;\n\n  user: Participating = {\n    winner: false,\n    email: null,\n    uid: null,\n  };\n\n  constructor(\n    private readonly activatedRoute: ActivatedRoute,\n    private firebaseAppService: FirebaseAppService,\n    private messages: MessagesService,\n    private loginService: LoginService,\n    public alertController: AlertController,\n    private navCtrl: NavController) {\n    this.getInfo();\n  }\n\n  ngOnInit() { }\n\n  /**\n   * OBTENER DATOS DEL SORTEO SELECCIONADO\n   */\n  async getInfo() {\n    try {\n      await this.messages.showSpinner();\n      const MyDate = new Date();\n      this.date = ('0' + MyDate.getDate()).slice(-2) + '-' + ('0' + (MyDate.getMonth() + 1)).slice(-2) + '-' + MyDate.getFullYear();\n      const res = await this.firebaseAppService.getDataUniqueDraw('27-07-2020', this.activatedRoute.snapshot.params.id);  // ! OJO: FECHA DE PRUEBA\n      const r = await this.firebaseAppService.checkUserHasParticipated('27-07-2020', this.activatedRoute.snapshot.params.id);\n      this.checking = await r.subscribe(async (datos: any) => { // ! OJO: CON EL SUBCRIBE- DESUCRBIBE\n\n        await datos.forEach(item => {\n          const check = item.payload.doc.data();\n          if (check.uid && check.uid === this.loginService.user.uid) {\n            this.participated = true;\n          }\n        });\n\n      });\n      this.result = await res.subscribe(async (d: any) => { // ! OJO: CON EL SUBCRIBE- DESUCRBIBE\n        this.data = await d.payload.data();\n      });\n    } catch (error) {\n      console.error(error);\n      await this.messages.hideSpinner();\n    } finally {\n      await this.messages.hideSpinner();\n    }\n  }\n\n  /**\n   * APUNTARSE A UN SORTEO\n   */\n  async takePartDraw() {\n    const alert = await this.alertController.create({\n      cssClass: 'my-custom-class',\n      header: 'Aviso',\n      message: '¿Está seguro que desea participar en el sorteo?',\n      backdropDismiss: false,\n      buttons: [\n        {\n          text: 'Cancelar',\n        }, {\n          text: 'Aceptar',\n          handler: async () => {\n            try {\n              await this.messages.showSpinner('Cargando...');\n              this.user.email = this.loginService.user.email;\n              this.user.uid = this.loginService.user.uid;\n              await this.firebaseAppService.takePartOnlyDraw('27-07-2020', this.activatedRoute.snapshot.params.id, this.user);  // ! OJO: FECHA DE PRUEBA\n              await this.messages.showToast('Su participación se ha realizado con éxito');\n              this.navCtrl.back();\n            } catch (error) {\n              console.error(error);\n              await this.messages.hideSpinner();\n            } finally {\n              await this.messages.hideSpinner();\n            }\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n  ngOnDestroy() {\n    this.result.unsubscribe();\n    this.checking.unsubscribe();\n  }\n\n}\n"]}