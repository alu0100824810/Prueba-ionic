{"version":3,"sources":["webpack:///src/app/views/pages/contest-draw/take-part/take-part.page.html","webpack:///src/app/views/pages/contest-draw/take-part/take-part.module.ts","webpack:///src/app/views/pages/contest-draw/take-part/take-part.page.scss","webpack:///src/app/views/pages/contest-draw/take-part/take-part.page.ts"],"names":["routes","path","component","TakePartPageModule","imports","forChild","declarations","TakePartPage","activatedRoute","firebaseAppService","messages","alertController","navCtrl","data","participated","user","winner","email","uid","getInfo","showSpinner","getDataUniqueDraw","snapshot","params","id","res","subscribe","d","payload","result","console","error","hideSpinner","create","cssClass","header","message","backdropDismiss","buttons","text","handler","updateParticiped","takePartOnlyDraw","showToast","back","alert","present","unsubscribe","selector","template"],"mappings":"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","file":"views-pages-contest-draw-take-part-take-part-module-es5.js","sourcesContent":["export default \"<app-header [showBackButton]=\\\"false\\\" name=\\\"Concursos-sorteos\\\">\\n  <ion-buttons start>\\n    <ion-back-button defaultHref=\\\"/contest-draw\\\" text=\\\"\\\" icon=\\\"chevron-back-outline\\\"></ion-back-button>\\n  </ion-buttons>\\n</app-header>\\n\\n<ion-content>\\n  <ng-container *ngIf=\\\"data != null\\\">\\n    <ion-card>\\n      <img [src]=\\\"data.img\\\" />-\\n      <ion-card-header>\\n        <ion-card-title>{{data.title}}</ion-card-title>\\n      </ion-card-header>\\n      <ion-card-content> {{data.info }}</ion-card-content>\\n    </ion-card>\\n    <br>\\n\\n    <div class=\\\"take-part\\\">\\n      <ng-container [ngSwitch]=\\\"participated\\\">\\n        <ion-button *ngSwitchCase=\\\"true\\\" expand=\\\"block\\\" shape=\\\"round\\\" disabled=\\\"true\\\">Ya has participado</ion-button>\\n        <ion-button *ngSwitchCase=\\\"false\\\" (click)=\\\"takePartDraw()\\\" expand=\\\"block\\\" shape=\\\"round\\\">PARTICIPAR</ion-button>\\n      </ng-container>\\n    </div>\\n  </ng-container>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { TakePartPage } from './take-part.page';\nimport { SharedModule } from 'app/shared/shared.module';\nimport { RouterModule, Routes } from '@angular/router';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: TakePartPage\n  }\n];\n@NgModule({\n  imports: [\n    CommonModule,\n    SharedModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [TakePartPage]\n})\nexport class TakePartPageModule {}\n","export default \".take-part {\\n  display: flex;\\n  justify-content: center;\\n}\\n.take-part ion-button {\\n  --background: var(--ion-color-secondary);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdmlld3MvcGFnZXMvY29udGVzdC1kcmF3L3Rha2UtcGFydC90YWtlLXBhcnQucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksYUFBQTtFQUNBLHVCQUFBO0FBQ0o7QUFDSTtFQUNJLHdDQUFBO0FBQ1IiLCJmaWxlIjoic3JjL2FwcC92aWV3cy9wYWdlcy9jb250ZXN0LWRyYXcvdGFrZS1wYXJ0L3Rha2UtcGFydC5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIudGFrZS1wYXJ0IHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuXG4gICAgaW9uLWJ1dHRvbiB7XG4gICAgICAgIC0tYmFja2dyb3VuZDogdmFyKC0taW9uLWNvbG9yLXNlY29uZGFyeSk7XG4gICAgfVxufSJdfQ== */\";","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport { ContestDraw, Participating } from 'app/shared/models/Contest-Draw.Model';\nimport { ActivatedRoute } from '@angular/router';\nimport { FirebaseAppService } from '@core/services/firebase-app.service';\nimport { MessagesService } from '@core/services/messages.service';\nimport { AlertController, NavController } from '@ionic/angular';\nimport { generateDateNow } from 'app/shared/utils/functionsUtils';\n\n@Component({\n  selector: 'app-take-part',\n  templateUrl: './take-part.page.html',\n  styleUrls: ['./take-part.page.scss'],\n})\nexport class TakePartPage implements OnInit, OnDestroy {\n\n  data: ContestDraw = null;\n  result: any; // TODO: CAMBIAR NOMBRE\n  checking: any; // TODO: CAMBIAR NOMBRE\n  participated = false;\n\n  user: Participating = {\n    winner: false,\n    email: null,\n    uid: null,\n  };\n\n  constructor(\n    private readonly activatedRoute: ActivatedRoute,\n    private firebaseAppService: FirebaseAppService,\n    private messages: MessagesService,\n    public alertController: AlertController,\n    private navCtrl: NavController) {\n    this.getInfo();\n  }\n\n  ngOnInit() { }\n\n  /**\n   * OBTENER DATOS DEL SORTEO SELECCIONADO\n   */\n  async getInfo() {\n    try {\n      await this.messages.showSpinner();\n      const res = await this.firebaseAppService.getDataUniqueDraw(generateDateNow(), this.activatedRoute.snapshot.params.id);\n      this.result = await res.subscribe(async (d: any) => {\n        this.data = await d.payload.data();\n        this.participated = this.data.participated ? this.data.participated : false;\n      });\n    } catch (error) {\n      console.error(error);\n      await this.messages.hideSpinner();\n    } finally {\n      await this.messages.hideSpinner();\n    }\n  }\n\n  /**\n   * APUNTARSE A UN SORTEO\n   */\n  async takePartDraw() {\n    const alert = await this.alertController.create({\n      cssClass: 'my-custom-class',\n      header: 'Aviso',\n      message: '¿Está seguro que desea participar en el sorteo?',\n      backdropDismiss: false,\n      buttons: [\n        {\n          text: 'Cancelar',\n        }, {\n          text: 'Aceptar',\n          handler: async () => {\n            try {\n              await this.messages.showSpinner('Cargando...');\n              this.data.participated = true;\n              await this.firebaseAppService.updateParticiped(generateDateNow(), this.activatedRoute.snapshot.params.id, this.data);\n              await this.firebaseAppService.takePartOnlyDraw(generateDateNow(), this.activatedRoute.snapshot.params.id);\n              await this.messages.showToast('Su participación se ha realizado con éxito');\n              this.navCtrl.back();\n            } catch (error) {\n              console.error(error);\n              await this.messages.hideSpinner();\n            } finally {\n              await this.messages.hideSpinner();\n            }\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n  ngOnDestroy() {\n    this.result.unsubscribe();\n   // this.checking.unsubscribe();\n  }\n\n}\n"]}