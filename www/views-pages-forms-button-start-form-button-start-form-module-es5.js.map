{"version":3,"sources":["webpack:///src/app/views/pages/forms/button-start-form/button-start-form.page.html","webpack:///src/app/views/pages/forms/button-start-form/button-start-form.module.ts","webpack:///src/app/views/pages/forms/button-start-form/button-start-form.page.scss","webpack:///src/app/views/pages/forms/button-start-form/button-start-form.page.ts"],"names":["routes","path","component","ButtonStartFormPageModule","imports","forChild","declarations","ButtonStartFormPage","activatedRoute","alertController","messages","firebaseAppService","navCtrl","loginService","infoService","category","dateToday","uid","done","checkForm","showSpinner","MyDate","Date","getDate","slice","getMonth","getFullYear","snapshot","params","user","getFormByID","prueba","result","subscribe","res","payload","data","r","info","showAlert","ngOnDestroy","console","error","hideSpinner","message","header","create","cssClass","backdropDismiss","buttons","text","handler","back","alert","present","unsubscribe","selector","template"],"mappings":"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","file":"views-pages-forms-button-start-form-button-start-form-module-es5.js","sourcesContent":["export default \"<app-header class=\\\"ion-text-capitalize\\\" [showBackButton]=\\\"false\\\" name=\\\"Categoria {{infoService.category}}\\\">\\n  <ion-buttons start>\\n    <ion-back-button defaultHref=\\\"/category-forms\\\" text=\\\"\\\" icon=\\\"chevron-back-outline\\\"></ion-back-button>\\n  </ion-buttons>\\n</app-header>\\n\\n<ion-content>\\n  <div class=\\\"button-start\\\" *ngIf=\\\"!infoService.done\\\">\\n    <ion-button expand=\\\"block\\\" fill=\\\"outline\\\" shape=\\\"round\\\" size=\\\"large\\\" [routerLink]=\\\"['./fill-out']\\\">\\n      Empezar encuesta\\n    </ion-button>\\n  </div>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Routes } from '@angular/router';\nimport { SharedModule } from 'app/shared/shared.module';\nimport { ButtonStartFormPage } from './button-start-form.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ButtonStartFormPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    SharedModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [ButtonStartFormPage]\n})\nexport class ButtonStartFormPageModule {}\n","export default \".button-start {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  height: 100%;\\n}\\n.button-start ion-button {\\n  --background: var(--ion-color-primary);\\n  color: var(--ion-color-primary-contrast);\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdmlld3MvcGFnZXMvZm9ybXMvYnV0dG9uLXN0YXJ0LWZvcm0vYnV0dG9uLXN0YXJ0LWZvcm0ucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksYUFBQTtFQUNBLG1CQUFBO0VBQ0EsdUJBQUE7RUFDQSxZQUFBO0FBQ0o7QUFDSTtFQUNJLHNDQUFBO0VBQ0Esd0NBQUE7QUFDUiIsImZpbGUiOiJzcmMvYXBwL3ZpZXdzL3BhZ2VzL2Zvcm1zL2J1dHRvbi1zdGFydC1mb3JtL2J1dHRvbi1zdGFydC1mb3JtLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5idXR0b24tc3RhcnR7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgIGhlaWdodDogMTAwJTtcblxuICAgIGlvbi1idXR0b24ge1xuICAgICAgICAtLWJhY2tncm91bmQ6IHZhcigtLWlvbi1jb2xvci1wcmltYXJ5KTtcbiAgICAgICAgY29sb3I6IHZhcigtLWlvbi1jb2xvci1wcmltYXJ5LWNvbnRyYXN0ICk7XG4gICAgfVxufSJdfQ== */\";","import { Component, OnInit , OnDestroy} from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { AlertController, NavController } from '@ionic/angular';\nimport { MessagesService } from '@core/services/messages.service';\nimport { FirebaseAppService } from '@core/services/firebase-app.service';\nimport { FormInfo } from 'app/shared/models/FormModel';\nimport { LoginService } from '@core/services/login.service';\nimport { Observable } from 'rxjs';\n\n\n@Component({\n  selector: 'app-button-start-form',\n  templateUrl: './button-start-form.page.html',\n  styleUrls: ['./button-start-form.page.scss'],\n})\nexport class ButtonStartFormPage implements OnInit , OnDestroy {\n\n  infoService = {\n    category: '',\n    dateToday: '',\n    uid: '',\n    done: null,\n  };\n\n  result: any; // TODO: CAMBIAR NOMBRE\n\n  constructor(\n    private readonly activatedRoute: ActivatedRoute,\n    public alertController: AlertController,\n    private messages: MessagesService,\n    private firebaseAppService: FirebaseAppService,\n    private navCtrl: NavController,\n    private readonly loginService: LoginService,\n  ) {\n    this.checkForm();\n   }\n\n  ngOnInit() {}\n\n  async checkForm() {\n    try {\n      await this.messages.showSpinner();\n      const MyDate = new Date();\n      this.infoService.dateToday = ('0' + MyDate.getDate()).slice(-2) + '-' + ('0' + (MyDate.getMonth() + 1)).slice(-2) + '-' + MyDate.getFullYear();\n      this.infoService.category = this.activatedRoute.snapshot.params.category;\n      this.infoService.uid = this.loginService.user.uid;\n      // TODO: LA FECHA ES DE PRUEBA\n      let prueba = await this.firebaseAppService.getFormByID(this.infoService.category, '27-07-2020', this.infoService.uid);\n      this.result = prueba.subscribe( async (res: any) => {\n        const r: FormInfo =  await res.payload.data();\n        this.infoService.done = r.info.done;\n        if (this.infoService.done) {\n          await this.showAlert('Esta encuesta ya ha sido realizada.', 'Aviso');\n         }\n        await this.ngOnDestroy();\n      });\n    } catch (error) {\n      console.error(error);\n      await this.messages.hideSpinner();\n      await this.showAlert('Se ha producido un error.', 'Error');\n    } finally {\n      await this.messages.hideSpinner();\n    }\n\n  }\n\n\n  /**\n   * Mostrar mensaje de error\n   * @param message mensaje de error\n   */\n  async showAlert(message: string, header: string) {\n    const alert = await this.alertController.create({\n      cssClass: 'alert-error',\n      header,\n      message,\n      backdropDismiss: false,\n      buttons: [\n        {\n          text: 'AtrÃ¡s',\n          cssClass: 'secondary',\n          handler: () => {\n            this.navCtrl.back();\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n  ngOnDestroy() {\n    this.result.unsubscribe();\n  }\n\n}\n"]}